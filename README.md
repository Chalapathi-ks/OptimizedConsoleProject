# Self-Serve Automation

Selenium automation suite for Self Serve UI

## Running Tests

### Run locally (no Grid)

Do **not** pass `-DhubUrl`. ChromeDriver is auto-downloaded to match your installed Chrome (via WebDriverManager).

```bash
mvn test -P[Profile] -Denv.profile=[Profile] -DsuiteXmlFile=src/test/resources/testNG/[SuiteFile].xml
```

Example (UK, single test):
```bash
mvn test -PProdUK -Denv.profile=ProdUK -DsuiteXmlFile=src/test/resources/testNG/SingleTest-BrowsePinPreview.xml
```

To force local when `hubUrl` might be set elsewhere: add `-DhubUrl=` to the command.

### Run on Selenium Grid

```bash
mvn test -P[Profile] -DsuiteXmlFile=src/test/resources/testNG/[SuiteFile].xml -DhubUrl=[SeleniumGridURL]
```

Example:
```bash
mvn test -PProdUK -DsuiteXmlFile=src/test/resources/testNG/MerchandizingTestcases.xml -DhubUrl=http://selenium-hub.netcorein.com:4444/wd/hub
```

### Rerun Failed Tests

When a test suite fails, TestNG automatically generates a `testng-failed.xml` file in `target/surefire-reports/` containing only the failed tests.

#### Option 1: Using the Script (Recommended)

**Linux/Mac:**
```bash
./rerun-failed-tests.sh [Profile] [HubUrl]
```

**Windows:**
```cmd
rerun-failed-tests.bat [Profile] [HubUrl]
```

Examples:
```bash
# Using default ProdUK profile and default hub URL
./rerun-failed-tests.sh

# Specify profile and hub URL
./rerun-failed-tests.sh ProdUS http://selenium-hub.netcorein.com:4444/wd/hub
```

#### Option 2: Using Maven Directly

```bash
mvn test -P[Profile] -Denv.profile=[Profile] -DhubUrl=[HubUrl] -DsuiteXmlFile=target/surefire-reports/testng-failed.xml
```

Example:
```bash
mvn test -PProdUK -Denv.profile=ProdUK -DhubUrl=http://selenium-hub.netcorein.com:4444/wd/hub -DsuiteXmlFile=target/surefire-reports/testng-failed.xml
```

## Available Profiles

- `Dev`
- `ProdGCP`
- `ProdAPAC`
- `ProdUS`
- `ProdUK`
- `ProdANZ`
- `ProdGANZ`

## Notes

- The `testng-failed.xml` file is automatically generated by TestNG's `FailedReporter` listener after a test run completes.
- If no tests failed, the script will exit with a success message.
- The failed tests XML is overwritten each time you run a new test suite.
